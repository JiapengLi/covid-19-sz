## 数据提取正则表达式备忘

```
0. sumatra pdf 中全选数据，复制到 sublime text

1. 数据格式化，将换行替换为空格
\n -> space

2. 按病例将数据分行
(例 病例\d+) 
	替换为
\n\1

3. 手动清洗数据
	a. 去除首行数据；
	b. 去除 368 和 369 间多余的一行数据 （343）；

4. 处理注释数据
	\*.*    （全部选择后剪切）

5. 进一步格式化数据
	a. 病例编号后增加分隔符
	(例 病例\d+)
		替换为
	\1，
	b. 移除所有空格
	
	

6. 提取性别年龄： （手动处理病例 156）
^.+?(\d+).+?(\d+)[ ]?岁(.)[性童].*
\1\t\2\t\3
注意：替换后复制，然后撤销，得到如下文本：
1	66	男
2	65	女
3	36	男
4	10	男
5	63	女

7. 关联病例提取
^.+?(\d+)，(（（例病例(\d+)[的]?(.+?)）){0,1}.*
\1\t\3\t\4


8. 入院时间
a. 提取所有相关文本，包含所有相关信息,抓取后统一存放在一个新文件
^例病例\d+，|((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)|入院
注意：根据正则表达式选择文本，粘贴至一个新文件

b. 按病例将数据存储在同一行
\n(?!例) 替换为 \t

c. 在新文件下用如下正则表达式提取信息
^例病例\d+，|((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)\t入院

d. 将数据按病例整理为一行
\n(?!例) 替换为 \t

e. 还原时间格式
(\d+) ?[年月日] ?(\d+) ?[年月日] 替换为 2020/\1/\2
针对1月的时间：(\d+) ?[年月日] 替换为 2020/01/\1
针对2月的时间：(\d+) ?[年月日] 替换为 2020/02/\1

注意：
	一部分时间仅有日属性，没有月属性，不同月份的数据需分别替换，可以将文件手动分割成两个文件
	病例 280 为 2 月 3 日入院

9 出院时间
^例病例\d+，|((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)|出院

\n(?!例) 替换为 \t

^例病例\d+，|((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)\t((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)\t出院

10. 居住地

^例病例\d+，|[^，。\n]+住[^，。\n]+|[^，。\n]+居[^，。\n]+

11. 湖北武汉关联性
^例病例\d+，|湖北|武汉


9 发病时间
^例病例\d+，|((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)|发病

\n(?!例) 替换为 \t

^例病例\d+，|((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)\t((\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?(\d+ ?[年月日] ?)?)\t出院


```



